---
layout: post
title:  A Neural Algorithm of Artistic Style
published: true
---

An overview of the paper “[A Neural Algorithm of Artistic Style](https://arxiv.org/pdf/1508.06576.pdf)”.
<!--break-->
In this paper, the authors propose a novel artificial system based on a Deep Neural Network that creates artistic images of high perceptual quality. All images and tables in this post are from their paper.

## Introduction

The key finding of this paper is that the representations of content and style in the Convolutional Neural Network are separable. That is, we can manipulate both representations independently to produce new, perceptually meaningful images. This can be explained as follows: when learning object recognition, the network has to become invariant to all image variation that preserves object identity. Representations that factorise the variation in the content of an image and the variation in its appearance would be extremely practical for this task. Thus, our ability to abstract content from style and therefore our ability to create and enjoy art might be primarily a preeminent signature of the powerful inference capabilities of our visual system.

## Content Loss

The results presented in this paper were generated by training a VGG Network without any fully connected layers. For image synthesis, replacing the
max-pooling operation by average pooling improves the gradient flow and one obtains slightly more appealing results.So let <img src="https://latex.codecogs.com/svg.latex?\overrightarrow{p}" title="\overrightarrow{p}" /> and <img src="https://latex.codecogs.com/svg.latex?\overrightarrow{x}" title="\overrightarrow{x}" /> be the original image and the image that is generated and <img src="https://latex.codecogs.com/svg.latex?P_l" title="P_l" /> and <img src="https://latex.codecogs.com/svg.latex?F_l" title="F_l" /> their respective feature representation in layer <img src="https://latex.codecogs.com/svg.latex?l" title="l" />. We define the content loss as: <img src="https://latex.codecogs.com/svg.latex?L_{\mathit{content}}(\overrightarrow{p},\overrightarrow{x},&space;l)&space;=&space;\frac{1}{2}\sum&space;_{i,j}(F_{ij}^l-P_{i,j}^l)^2" title="L_{\mathit{content}}(\overrightarrow{p},\overrightarrow{x}, l) = \frac{1}{2}\sum _{i,j}(F_{ij}^l-P_{i,j}^l)^2" /> This allows the system to maintatin the semantic similarity with the original image.

## Style Loss

To generate a texture that matches the style of a given image, we use gradient descent from a white noise image to find another image that matches the style representation of the original image. This is done by minimising the mean-squared distance between the entries of the Gram matrix from the original image and the Gram matrix of the image to be generated. So let ~a and ~x be the original image and the image that is generated and A_l and G_l their respective style representations in layer l. The contribution of that layer to the total loss is then: <img src="https://latex.codecogs.com/svg.latex?E_l&space;=&space;\frac{1}{4N_l^2M_l^2}\sum&space;_{i,j}(G_{ij}^l&space;-&space;A_{ij}^l)^2" title="E_l = \frac{1}{4N_l^2M_l^2}\sum _{i,j}(G_{ij}^l - A_{ij}^l)^2" />, where <img src="https://latex.codecogs.com/svg.latex?N_l" title="N_l" /> is number of distinct filters and <img src="https://latex.codecogs.com/svg.latex?M_l" title="M_l" /> is the size of each filter. The total style loss is defined as: <img src="https://latex.codecogs.com/svg.latex?L_{\mathit{style}}(\overrightarrow{\alpha},&space;\overrightarrow{x})&space;=&space;\sum&space;_{l=0}^L&space;w_lE_l" title="L_{\mathit{style}}(\overrightarrow{\alpha}, \overrightarrow{x}) = \sum _{l=0}^L w_lE_l" />. The <img src="https://latex.codecogs.com/svg.latex?w_l" title="w_l" /> is a hyperparameter in this case.

## Combining Losses

The total loss is defined as weighted sum of the content loss and style loss. These weights are also hyperparameters.

<p align="center">
<b>Examples of Images that combine content with style of various well-known artworks.</b>
</p>
<p align="center">
<img src="https://raw.githubusercontent.com/ramnathkumar181/ramnathkumar181.github.io/master/assets/Papers/30/Figure-1.png?raw=true" alt="Figure 1"/>
</p>
